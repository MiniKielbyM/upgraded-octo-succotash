!function(){"use strict";var t=function(){return t=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},t.apply(this,arguments)};function e(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]])}return n}function n(t,e,n,o){return new(n||(n=Promise))((function(i,r){function s(t){try{l(o.next(t))}catch(t){r(t)}}function a(t){try{l(o.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((o=o.apply(t,e||[])).next())}))}function o(t,e,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(t):o?o.value:e.get(t)}function i(t,e,n,o,i){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?i.call(t,n):i?i.value=n:e.set(t,n),n}"function"==typeof SuppressedError&&SuppressedError;const r="undefined"!=typeof localStorage,s=r&&localStorage.getItem("base.content.url")||"https://static.descope.com/pages",a="descope-login-flow",l="code",c="ra-challenge",d="ra-callback",u="ra-initiator",h="data-exclude-field",p="dls_last_auth",f="state_id",g="data-type",v="redirect",m="poll",b="webauthnCreate",w="webauthnGet",y="submit",k="polling";var I,x,O;function j(t){return new URLSearchParams(window.location.search).get(t)}function S(t){if(window.history.replaceState&&j(t)){const e=new URL(window.location.href),n=new URLSearchParams(e.search);n.delete(t),e.search=n.toString(),window.history.replaceState({},"",e.toString())}}function C(t,e){return n(this,void 0,void 0,(function*(){const n=yield fetch(t,{cache:"default"});if(!n.ok)throw Error(`Error fetching URL ${t} [${n.status}]`);return{body:yield n[e||"text"](),headers:Object.fromEntries(n.headers.entries())}}))}!function(t){t.backward="backward",t.forward="forward"}(I||(I={}));function A(t,e){const n=new URL(s);return n.pathname=((...t)=>t.join("/").replace(/\/+/g,"/"))(n.pathname,t,"v2-alpha",e),n.toString()}function E(t,e){if(!Number.isNaN(t)&&!Number.isNaN(e))return t>e?I.forward:t<e?I.backward:void 0}const U=()=>{const[t="",e=""]=(j(a)||"").split("_");return{executionId:t,stepId:e}};function _(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}function P(){S(a)}const R=t=>t.replace(/-./g,(t=>t[1].toUpperCase())),L=()=>{const{executionId:t,stepId:e}=U();(t||e)&&P();const n=j("t")||void 0;n&&S("t");const o=j(l)||void 0;o&&S(l);const i=j("err")||void 0;i&&S("err");const{redirectAuthCodeChallenge:r,redirectAuthCallbackUrl:s,redirectAuthInitiator:a}={redirectAuthCodeChallenge:j(c),redirectAuthCallbackUrl:j(d),redirectAuthInitiator:j(u)};(r||s||a)&&(S(c),S(d),S(u));const h=j(f);return h&&S(f),{executionId:t,stepId:e,token:n,code:o,exchangeError:i,redirectAuthCodeChallenge:r,redirectAuthCallbackUrl:s,redirectAuthInitiator:a,oidcIdpStateId:h}},T=t=>{let e,n;return(...o)=>{return e&&(r=o,(i=e).length===r.length&&i.every(((t,e)=>t===r[e])))||(e=o,n=t(...o)),n;var i,r}},$=null===(O=null===(x=null===navigator||void 0===navigator?void 0:navigator.userAgentData)||void 0===x?void 0:x.brands)||void 0===O?void 0:O.find((({brand:t,version:e})=>"Chromium"===t&&parseFloat(e))),q=(t,e)=>t&&!e;var M,W,D,N;function F(t,e){const n=Object.getOwnPropertyNames(t),o=Object.getOwnPropertyNames(e);if(n.length!==o.length)return!1;for(let o=0;o<n.length;o+=1){const i=n[o],r=t[i],s=e[i];if(null===r||null===s){if(r!==s)return!1}else if("object"==typeof r&&"object"==typeof s){if(!F(r,s))return!1}else if(r!==s)return!1}return!0}class K{constructor(t={},{updateOnlyOnChange:e=!0}={}){M.set(this,void 0),W.set(this,{}),D.set(this,0),N.set(this,!1),this.update=t=>{const e="function"==typeof t?t(o(this,M,"f")):t,n=Object.assign(Object.assign({},o(this,M,"f")),e);if(!o(this,N,"f")||!F(o(this,M,"f"),n)){const t=o(this,M,"f");i(this,M,n,"f"),Object.freeze(o(this,M,"f")),setTimeout((()=>{Object.values(o(this,W,"f")).forEach((e=>e(n,t,((t,e)=>n=>t[n]!==e[n])(n,t))))}),0)}},i(this,M,t,"f"),i(this,N,e,"f")}get current(){return Object.assign({},o(this,M,"f"))}subscribe(t){return i(this,D,o(this,D,"f")+1,"f"),o(this,W,"f")[o(this,D,"f")]=t,o(this,D,"f").toString()}unsubscribe(t){const e=!!o(this,W,"f")[t];return e&&delete o(this,W,"f")[t],e}unsubscribeAll(){return i(this,W,{},"f"),!0}}M=new WeakMap,W=new WeakMap,D=new WeakMap,N=new WeakMap;const J=(t,e)=>{Object.entries(e||{}).forEach((([e,n])=>{Array.from(t.querySelectorAll(`.descope-input[name="${e}"]:not([${h}])`)).forEach((t=>{t.value=n}))}))},H=(t,e,n,o)=>{var i;let r=null==e?void 0:e.errorText;try{r=(null==n?void 0:n({text:null==e?void 0:e.errorText,type:null==e?void 0:e.errorType}))||(null==e?void 0:e.errorText)}catch(t){o.error("Error transforming error message",t.message)}((t,e,n="")=>{t.querySelectorAll(`[${g}="${e}"]`).forEach((t=>{t.textContent=n,t.classList[n?"remove":"add"]("hide")}))})(t,"error-message",r),J(t,null==e?void 0:e.inputs),J(t,null==e?void 0:e.form),((t,e)=>{t.querySelectorAll(`[${g}="totp-link"]`).forEach((t=>{t.href=e}))})(t,null===(i=null==e?void 0:e.totp)||void 0===i?void 0:i.provisionUrl),((t,e)=>{t.querySelectorAll(".descope-text,.descope-link").forEach((t=>{t.textContent=((t,e)=>t.replace(/{{(.+?)}}/g,((t,n)=>{return o=e,n.split(".").reduce(((t,e)=>(null==t?void 0:t[e])||""),o);var o})))(t.textContent,e)}))})(t,e)},z=T((()=>n(void 0,void 0,void 0,(function*(){var t,e,n,o;if(!window.PublicKeyCredential||!PublicKeyCredential.isConditionalMediationAvailable||!PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable)return console.warn("webauthn","Conditional UI is not supported"),!1;try{const i=Promise.all([null===(t=window.PublicKeyCredential)||void 0===t?void 0:t.isConditionalMediationAvailable(),null===(e=window.PublicKeyCredential)||void 0===e?void 0:e.isUserVerifyingPlatformAuthenticatorAvailable()]).then((t=>t.every((t=>!!t)))),r=108;return yield Promise.race([i,(n=100,new Promise(((t,e)=>{const i=setTimeout((()=>{e(new Error(`Promise timed out after ${n} ms`))}),n);null==o||o((e=>{clearTimeout(i),t(e)}),(t=>{clearTimeout(i),e(t)}))}))).catch((()=>$()>=r))])}catch(t){return console.warn("webauthn","Conditional login check failed",t),!1}})))),B=(t,e,n,o={})=>{var i,r,s,a;return[Math.min(Math.max(e,("all"===o.left?t.offsetWidth:null!==(i=o.left)&&void 0!==i?i:0)-t.offsetWidth),window.innerWidth-("all"===o.right?t.offsetWidth:null!==(r=o.right)&&void 0!==r?r:0)),Math.min(Math.max(n,("all"===o.top?t.offsetHeight:null!==(s=o.top)&&void 0!==s?s:0)-t.offsetHeight),window.innerHeight-("all"===o.bottom?t.offsetHeight:null!==(a=o.bottom)&&void 0!==a?a:0))]},V={"lastAuth.loginId":{"not-empty":t=>!!t.loginId,empty:t=>!t.loginId},idpInitiated:{"is-true":t=>!!t.code,"is-false":t=>!t.code},externalToken:{"is-true":t=>!!t.token,"is-false":t=>!t.token}};function Z(t){const e={};if(t)try{Object.assign(e,JSON.parse(localStorage.getItem(p)))}catch(t){}return e}function G(t){this.message=t}G.prototype=new Error,G.prototype.name="InvalidCharacterError";var X="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new G("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,i=0,r=0,s="";o=e.charAt(r++);~o&&(n=i%4?64*n+o:o,i++%4)?s+=String.fromCharCode(255&n>>(-2*i&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return s};function Y(t){this.message=t}function Q(t,e){if("string"!=typeof t)throw new Y("Invalid token specified");var n=!0===(e=e||{}).header?0:1;try{return JSON.parse(function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(t){return decodeURIComponent(X(t).replace(/(.)/g,(function(t,e){var n=e.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(e)}catch(t){return X(e)}}(t.split(".")[n]))}catch(t){throw new Y("Invalid token specified: "+t.message)}}Y.prototype=new Error,Y.prototype.name="InvalidTokenError";var tt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},et="__lodash_hash_undefined__",nt=1/0,ot="[object Function]",it="[object GeneratorFunction]",rt="[object Symbol]",st=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,at=/^\w*$/,lt=/^\./,ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/\\(\\)?/g,ut=/^\[object .+?Constructor\]$/,ht="object"==typeof tt&&tt&&tt.Object===Object&&tt,pt="object"==typeof self&&self&&self.Object===Object&&self,ft=ht||pt||Function("return this")();var gt,vt=Array.prototype,mt=Function.prototype,bt=Object.prototype,wt=ft["__core-js_shared__"],yt=(gt=/[^.]+$/.exec(wt&&wt.keys&&wt.keys.IE_PROTO||""))?"Symbol(src)_1."+gt:"",kt=mt.toString,It=bt.hasOwnProperty,xt=bt.toString,Ot=RegExp("^"+kt.call(It).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),jt=ft.Symbol,St=vt.splice,Ct=Mt(ft,"Map"),At=Mt(Object,"create"),Et=jt?jt.prototype:void 0,Ut=Et?Et.toString:void 0;function _t(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function Pt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function Rt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function Lt(t,e){for(var n,o,i=t.length;i--;)if((n=t[i][0])===(o=e)||n!=n&&o!=o)return i;return-1}function Tt(t,e){var n;e=function(t,e){if(Ft(t))return!1;var n=typeof t;if("number"==n||"symbol"==n||"boolean"==n||null==t||Jt(t))return!0;return at.test(t)||!st.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:Ft(n=e)?n:Wt(n);for(var o=0,i=e.length;null!=t&&o<i;)t=t[Dt(e[o++])];return o&&o==i?t:void 0}function $t(t){if(!Kt(t)||(e=t,yt&&yt in e))return!1;var e,n=function(t){var e=Kt(t)?xt.call(t):"";return e==ot||e==it}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?Ot:ut;return n.test(function(t){if(null!=t){try{return kt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function qt(t,e){var n,o,i=t.__data__;return("string"==(o=typeof(n=e))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function Mt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return $t(n)?n:void 0}_t.prototype.clear=function(){this.__data__=At?At(null):{}},_t.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},_t.prototype.get=function(t){var e=this.__data__;if(At){var n=e[t];return n===et?void 0:n}return It.call(e,t)?e[t]:void 0},_t.prototype.has=function(t){var e=this.__data__;return At?void 0!==e[t]:It.call(e,t)},_t.prototype.set=function(t,e){return this.__data__[t]=At&&void 0===e?et:e,this},Pt.prototype.clear=function(){this.__data__=[]},Pt.prototype.delete=function(t){var e=this.__data__,n=Lt(e,t);return!(n<0)&&(n==e.length-1?e.pop():St.call(e,n,1),!0)},Pt.prototype.get=function(t){var e=this.__data__,n=Lt(e,t);return n<0?void 0:e[n][1]},Pt.prototype.has=function(t){return Lt(this.__data__,t)>-1},Pt.prototype.set=function(t,e){var n=this.__data__,o=Lt(n,t);return o<0?n.push([t,e]):n[o][1]=e,this},Rt.prototype.clear=function(){this.__data__={hash:new _t,map:new(Ct||Pt),string:new _t}},Rt.prototype.delete=function(t){return qt(this,t).delete(t)},Rt.prototype.get=function(t){return qt(this,t).get(t)},Rt.prototype.has=function(t){return qt(this,t).has(t)},Rt.prototype.set=function(t,e){return qt(this,t).set(t,e),this};var Wt=Nt((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(Jt(t))return Ut?Ut.call(t):"";var e=t+"";return"0"==e&&1/t==-nt?"-0":e}(e);var n=[];return lt.test(t)&&n.push(""),t.replace(ct,(function(t,e,o,i){n.push(o?i.replace(dt,"$1"):e||t)})),n}));function Dt(t){if("string"==typeof t||Jt(t))return t;var e=t+"";return"0"==e&&1/t==-nt?"-0":e}function Nt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var o=arguments,i=e?e.apply(this,o):o[0],r=n.cache;if(r.has(i))return r.get(i);var s=t.apply(this,o);return n.cache=r.set(i,s),s};return n.cache=new(Nt.Cache||Rt),n}Nt.Cache=Rt;var Ft=Array.isArray;function Kt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Jt(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&xt.call(t)==rt}var Ht=function(t,e,n){var o=null==t?void 0:Tt(t,e);return void 0===o?n:o},zt="/v1/auth/accesskey/exchange",Bt="/v1/auth/otp/verify",Vt="/v1/auth/otp/signin",Zt="/v1/auth/otp/signup",Gt={email:"/v1/auth/otp/update/email",phone:"/v1/auth/otp/update/phone"},Xt="/v1/auth/otp/signup-in",Yt="/v1/auth/magiclink/verify",Qt="/v1/auth/magiclink/signin",te="/v1/auth/magiclink/signup",ee={email:"/v1/auth/magiclink/update/email",phone:"/v1/auth/magiclink/update/phone"},ne="/v1/auth/magiclink/signup-in",oe="/v1/auth/enchantedlink/verify",ie="/v1/auth/enchantedlink/signin",re="/v1/auth/enchantedlink/signup",se="/v1/auth/enchantedlink/pending-session",ae={email:"/v1/auth/enchantedlink/update/email"},le="/v1/auth/enchantedlink/signup-in",ce="/v1/auth/oauth/authorize",de="/v1/auth/oauth/exchange",ue="/v1/auth/saml/authorize",he="/v1/auth/saml/exchange",pe="/v1/auth/totp/verify",fe="/v1/auth/totp/signup",ge="/v1/auth/totp/update",ve={start:"/v1/auth/webauthn/signup/start",finish:"/v1/auth/webauthn/signup/finish"},me={start:"/v1/auth/webauthn/signin/start",finish:"/v1/auth/webauthn/signin/finish"},be={start:"/v1/auth/webauthn/signup-in/start"},we={start:"v1/auth/webauthn/update/start",finish:"/v1/auth/webauthn/update/finish"},ye="/v1/auth/password/signup",ke="/v1/auth/password/signin",Ie="/v1/auth/password/reset",xe="/v1/auth/password/update",Oe="/v1/auth/password/replace",je="/v1/auth/password/policy",Se="/v1/auth/refresh",Ce="/v1/auth/logout",Ae="/v1/auth/logoutall",Ee="/v1/auth/me",Ue="/v1/flow/start",_e="/v1/flow/next";const Pe=6e5,Re=()=>{const t={};return{headers(e){const n="function"==typeof e.entries?Object.fromEntries(e.entries()):e;return t.Headers=JSON.stringify(n),this},body(e){return t.Body=e,this},url(e){return t.Url=e.toString(),this},method(e){return t.Method=e,this},title(e){return t.Title=e,this},status(e){return t.Status=e,this},build:()=>Object.keys(t).flatMap((e=>t[e]?[`${"Title"!==e?`${e}: `:""}${t[e]}`]:[])).join("\n")}};var Le;!function(t){t.get="GET",t.delete="DELETE",t.post="POST",t.put="PUT"}(Le||(Le={}));const Te=(...t)=>new Headers(t.reduce(((t,e)=>{const n=(t=>Array.isArray(t)?t:t instanceof Headers?Array.from(t.entries()):t?Object.entries(t):[])(e);return n.reduce(((e,[n,o])=>(t[n]=o,t)),t),t}),{})),$e=t=>void 0===t?void 0:JSON.stringify(t),qe=(t,e="")=>{let n=t;return e&&(n=n+":"+e),{Authorization:`Bearer ${n}`}},Me=({baseUrl:t,projectId:e,baseConfig:n,logger:o,hooks:i,cookiePolicy:r,fetch:s})=>{const a=((t,e)=>{const n=(t=>async(...e)=>{const n=await t(...e),o=await n.text();return n.text=()=>Promise.resolve(o),n.json=()=>Promise.resolve(JSON.parse(o)),n.clone=()=>n,n})(e||fetch);return n||null==t||t.warn("Fetch is not defined, you will not be able to send http requests, if you are running in a test, make sure fetch is defined globally"),t?async(...e)=>{if(!n)throw Error("Cannot send http request, fetch is not defined, if you are running in a test, make sure fetch is defined globally");t.log((t=>Re().title("Request").url(t[0]).method(t[1].method).headers(t[1].headers).body(t[1].body).build())(e));const o=await n(...e);return t[o.ok?"log":"error"](await(async t=>{const e=await t.text();return Re().title("Response").url(t.url.toString()).status(`${t.status} ${t.statusText}`).headers(t.headers).body(e).build()})(o)),o}:n})(o,s),l=async o=>{const s=(null==i?void 0:i.beforeRequest)?i.beforeRequest(o):o,{path:l,body:c,headers:d,queryParams:u,method:h,token:p}=s,f=await a((({path:t,baseUrl:e,queryParams:n})=>{const o=new URL(t,e);return n&&(o.search=new URLSearchParams(n).toString()),o})({path:l,baseUrl:t,queryParams:u}),{headers:Te(qe(e,p),{"x-descope-sdk-name":"core-js","x-descope-sdk-version":"1.7.3"},(null==n?void 0:n.baseHeaders)||{},d),method:h,body:$e(c),credentials:r||"include"});return(null==i?void 0:i.afterRequest)&&await i.afterRequest(o,null==f?void 0:f.clone()),f};return{get:(t,{headers:e,queryParams:n,token:o}={})=>l({path:t,headers:e,queryParams:n,body:void 0,method:Le.get,token:o}),post:(t,e,{headers:n,queryParams:o,token:i}={})=>l({path:t,headers:n,queryParams:o,body:e,method:Le.post,token:i}),put:(t,e,{headers:n,queryParams:o,token:i}={})=>l({path:t,headers:n,queryParams:o,body:e,method:Le.put,token:i}),delete:(t,{headers:e,queryParams:n,token:o}={})=>l({path:t,headers:e,queryParams:n,body:void 0,method:Le.delete,token:o}),hooks:i}};var We=429;function De(t,e,n){var o;let i=Ne(t);e&&(i=null===(o=null==i?void 0:i.tenants)||void 0===o?void 0:o[e]);const r=null==i?void 0:i[n];return Array.isArray(r)?r:[]}function Ne(t){if("string"!=typeof t||!t)throw new Error("Invalid token provided");return Q(t)}function Fe(t){const{exp:e}=Ne(t);return(new Date).getTime()/1e3>e}function Ke(t){let e=Ne(t);const n=Object.keys(null==e?void 0:e.tenants);return Array.isArray(n)?n:[]}function Je(t,e){return De(t,e,"permissions")}function He(t,e){return De(t,e,"roles")}const ze=(...t)=>t.join("/").replace(/\/{2,}/g,"/");async function Be(t,e){var n;const o=await t,i={code:o.status,ok:o.ok,response:o},r=await o.clone().json();return o.ok?i.data=e?e(r):r:(i.error=r,o.status===We&&Object.assign(i.error,{retryAfter:Number.parseInt(null===(n=o.headers)||void 0===n?void 0:n.get("retry-after"))||0})),i}const Ve=(t,e)=>(n=e)=>e=>!t(e)&&n.replace("{val}",e),Ze=(...t)=>({validate:e=>(t.forEach((t=>{const n=t(e);if(n)throw new Error(n)})),!0)}),Ge=t=>e=>t.test(e),Xe=Ge(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/),Ye=Ge(/^\+[1-9]{1}[0-9]{3,14}$/),Qe=Ve(Xe,'"{val}" is not a valid email'),tn=Ve(Ye,'"{val}" is not a valid phone number'),en=Ve((1,t=>t.length>=1),"Minimum length is 1");const nn=Ve((t=>"string"==typeof t),"Input is not a string"),on=Ve((t=>void 0===t),"Input is defined"),rn=(sn=[nn(),on()],"Input is not a string or undefined",(t="Input is not a string or undefined")=>e=>{const n=sn.filter((t=>t(e)));return!(n.length<sn.length)&&(t?t.replace("{val}",e):n.join(" OR "))});var sn;const an=(...t)=>e=>(...n)=>(t.forEach(((t,e)=>Ze(...t).validate(n[e]))),e(...n)),ln=t=>[nn(`"${t}" must be a string`),en(`"${t}" must not be empty`)],cn=t=>[nn(`"${t}" must be a string`),Qe()],dn=t=>[nn(`"${t}" must be a string`),tn()],un=an(ln("accessKey")),hn=t=>({exchange:un((e=>Be(t.post(zt,{},{token:e}))))});var pn,fn;!function(t){t.sms="sms",t.whatsapp="whatsapp"}(pn||(pn={})),function(t){t.email="email"}(fn||(fn={}));const gn=Object.assign(Object.assign({},pn),fn);var vn;!function(t){t.waiting="waiting",t.running="running",t.completed="completed",t.failed="failed"}(vn||(vn={}));const mn=ln("loginId"),bn=an(ln("token")),wn=an(mn),yn=an(ln("pendingRef")),kn=an(mn,cn("email")),In=t=>({verify:bn((e=>Be(t.post(oe,{token:e})))),signIn:wn(((e,n,o,i)=>Be(t.post(ze(ie,gn.email),{loginId:e,URI:n,loginOptions:o},{token:i})))),signUpOrIn:wn(((e,n)=>Be(t.post(ze(le,gn.email),{loginId:e,URI:n})))),signUp:wn(((e,n,o)=>Be(t.post(ze(re,gn.email),{loginId:e,URI:n,user:o})))),waitForSession:yn(((e,n)=>new Promise((o=>{const{pollingIntervalMs:i,timeoutMs:r}=(({pollingIntervalMs:t=1e3,timeoutMs:e=6e5}={})=>({pollingIntervalMs:Math.max(t||1e3,1e3),timeoutMs:Math.min(e||Pe,Pe)}))(n);let s;const a=setInterval((async()=>{const n=await t.post(se,{pendingRef:e});n.ok&&(clearInterval(a),s&&clearTimeout(s),o(Be(Promise.resolve(n))))}),i);s=setTimeout((()=>{o({error:{errorDescription:`Session polling timeout exceeded: ${r}ms`,errorCode:"0"},ok:!1}),clearInterval(a)}),r)})))),update:{email:kn(((e,n,o,i,r)=>Be(t.post(ae.email,Object.assign({loginId:e,email:n,URI:o},r),{token:i}))))}}),xn=an(ln("flowId")),On=an(ln("executionId"),ln("stepId"),ln("interactionId")),jn=t=>({start:xn(((e,n,o,i,r,s)=>Be(t.post(Ue,{flowId:e,options:n,conditionInteractionId:o,interactionId:i,input:r,version:s})))),next:On(((e,n,o,i,r)=>Be(t.post(_e,{executionId:e,stepId:n,interactionId:o,input:i,version:r}))))}),Sn=ln("loginId"),Cn=an(ln("token")),An=an(Sn),En=an(Sn,dn("phone")),Un=an(Sn,cn("email")),_n=t=>({verify:Cn((e=>Be(t.post(Yt,{token:e})))),signIn:Object.keys(gn).reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:An(((e,o,i,r)=>Be(t.post(ze(Qt,n),{loginId:e,URI:o,loginOptions:i},{token:r}))))})),{}),signUp:Object.keys(gn).reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:An(((e,o,i)=>Be(t.post(ze(te,n),{loginId:e,URI:o,user:i}))))})),{}),signUpOrIn:Object.keys(gn).reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:An(((e,o)=>Be(t.post(ze(ne,n),{loginId:e,URI:o}))))})),{}),update:{email:Un(((e,n,o,i,r)=>Be(t.post(ee.email,Object.assign({loginId:e,email:n,URI:o},r),{token:i})))),phone:Object.keys(pn).reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:En(((e,o,i,r,s)=>Be(t.post(ze(ee.phone,n),Object.assign({loginId:e,phone:o,URI:i},s),{token:r}))))})),{})}});var Pn;!function(t){t.facebook="facebook",t.github="github",t.google="google",t.microsoft="microsoft",t.gitlab="gitlab",t.apple="apple",t.discord="discord",t.linkedin="linkedin"}(Pn||(Pn={}));const Rn=an(ln("code")),Ln=t=>({start:Object.keys(Pn).reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:(e,o,i)=>Be(t.post(ce,o||{},{queryParams:Object.assign({provider:n},e&&{redirectURL:e}),token:i}))})),{}),exchange:Rn((e=>Be(t.post(de,{code:e}))))}),Tn=ln("loginId"),$n=an(Tn,ln("code")),qn=an(Tn),Mn=an(Tn,dn("phone")),Wn=an(Tn,cn("email")),Dn=t=>({verify:Object.keys(gn).reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:$n(((e,o)=>Be(t.post(ze(Bt,n),{code:o,loginId:e}))))})),{}),signIn:Object.keys(gn).reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:qn(((e,o,i)=>Be(t.post(ze(Vt,n),{loginId:e,loginOptions:o},{token:i}))))})),{}),signUp:Object.keys(gn).reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:qn(((e,o)=>Be(t.post(ze(Zt,n),{loginId:e,user:o}))))})),{}),signUpOrIn:Object.keys(gn).reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:qn((e=>Be(t.post(ze(Xt,n),{loginId:e}))))})),{}),update:{email:Wn(((e,n,o,i)=>Be(t.post(Gt.email,Object.assign({loginId:e,email:n},i),{token:o})))),phone:Object.keys(pn).reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:Mn(((e,o,i,r)=>Be(t.post(ze(Gt.phone,n),Object.assign({loginId:e,phone:o},r),{token:i}))))})),{})}}),Nn=an(ln("tenant")),Fn=an(ln("code")),Kn=t=>({start:Nn(((e,n,o,i)=>Be(t.post(ue,o||{},{queryParams:{tenant:e,redirectURL:n},token:i})))),exchange:Fn((e=>Be(t.post(he,{code:e}))))}),Jn=ln("loginId"),Hn=an(Jn,ln("code")),zn=an(Jn),Bn=an(Jn),Vn=t=>({signUp:zn(((e,n)=>Be(t.post(fe,{loginId:e,user:n})))),verify:Hn(((e,n,o,i)=>Be(t.post(pe,{loginId:e,code:n,loginOptions:o},{token:i})))),update:Bn(((e,n)=>Be(t.post(ge,{loginId:e},{token:n}))))}),Zn=ln("loginId"),Gn=ln("newPassword"),Xn=an(Zn,ln("password")),Yn=an(Zn),Qn=an(Zn,Gn),to=an(Zn,ln("oldPassword"),Gn),eo=t=>({signUp:Xn(((e,n,o)=>Be(t.post(ye,{loginId:e,password:n,user:o})))),signIn:Xn(((e,n)=>Be(t.post(ke,{loginId:e,password:n})))),sendReset:Yn(((e,n)=>Be(t.post(Ie,{loginId:e,redirectUrl:n})))),update:Qn(((e,n,o)=>Be(t.post(xe,{loginId:e,newPassword:n},{token:o})))),replace:to(((e,n,o)=>Be(t.post(Oe,{loginId:e,oldPassword:n,newPassword:o})))),policy:()=>Be(t.get(je))}),no=[nn('"loginId" must be a string')],oo=ln("loginId"),io=ln("origin"),ro=an(oo,io,ln("name")),so=an(oo,io),ao=an(no,io),lo=an(oo,io,ln("token")),co=an(ln("transactionId"),ln("response")),uo=t=>({signUp:{start:ro(((e,n,o)=>Be(t.post(ve.start,{user:{loginId:e,name:o},origin:n})))),finish:co(((e,n)=>Be(t.post(ve.finish,{transactionId:e,response:n}))))},signIn:{start:ao(((e,n,o,i)=>Be(t.post(me.start,{loginId:e,origin:n,loginOptions:o},{token:i})))),finish:co(((e,n)=>Be(t.post(me.finish,{transactionId:e,response:n}))))},signUpOrIn:{start:so(((e,n)=>Be(t.post(be.start,{loginId:e,origin:n}))))},update:{start:lo(((e,n,o)=>Be(t.post(we.start,{loginId:e,origin:n},{token:o})))),finish:co(((e,n)=>Be(t.post(we.finish,{transactionId:e,response:n}))))}}),ho=an(ln("token")),po=an([rn('"token" must be string or undefined')]);var fo,go=an([("projectId",fo=ln("projectId"),Ve(((t,e)=>n=>Ze(...e).validate(Ht(n,t)))("projectId",fo))())])((t=>{var e,n;const o=[].concat((null===(e=t.hooks)||void 0===e?void 0:e.beforeRequest)||[]),i=[].concat((null===(n=t.hooks)||void 0===n?void 0:n.afterRequest)||[]);return(({projectId:t,logger:e,baseUrl:n,hooks:o,cookiePolicy:i,baseHeaders:r={},fetch:s})=>{return a=Me({baseUrl:n||"https://api.descope.com",projectId:t,logger:e,hooks:o,cookiePolicy:i,baseConfig:{baseHeaders:r},fetch:s}),{accessKey:hn(a),otp:Dn(a),magicLink:_n(a),enchantedLink:In(a),oauth:Ln(a),saml:Kn(a),totp:Vn(a),webauthn:uo(a),password:eo(a),flow:jn(a),refresh:po((t=>Be(a.post(Se,{},{token:t})))),logout:po((t=>Be(a.post(Ce,{},{token:t})))),logoutAll:po((t=>Be(a.post(Ae,{},{token:t})))),me:po((t=>Be(a.get(Ee,{token:t})))),isJwtExpired:ho(Fe),getTenants:ho(Ke),getJwtPermissions:ho(Je),getJwtRoles:ho(He),httpClient:a};var a})(Object.assign(Object.assign({},t),{hooks:{beforeRequest:t=>null==o?void 0:o.reduce(((t,e)=>e(t)),t),afterRequest:async(e,n)=>{(await Promise.allSettled(null==i?void 0:i.map((t=>t(e,null==n?void 0:n.clone()))))).forEach((e=>{var n;return"rejected"===e.status&&(null===(n=t.logger)||void 0===n?void 0:n.error(e.reason))}))}}}))}));const vo=(t,e,n)=>(e.forEach((e=>{const o=e.split(".");let i=o.shift(),r=t;for(;o.length>0;){if(r=r[i],!i||!r)throw Error(`Invalid path "${e}", "${i}" is missing or has no value`);i=o.shift()}if("function"!=typeof r[i])throw Error(`"${e}" is not a function`);const s=r[i];r[i]=n(s)})),t);var mo=Object.assign(go,{DeliveryMethods:gn});var bo="Blocked by CSP",wo="9319";function yo(t,e){var n=[];return function(t,e){var n,o,i=(o=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))}([],t,!0),{current:function(){return o[0]},postpone:function(){var t=o.shift();void 0!==t&&o.push(t)},exclude:function(){o.shift()}}),r=(100,3e3,n=0,function(){return Math.random()*Math.min(3e3,100*Math.pow(2,n++))}),s=i.current();if(void 0===s)return Promise.reject(new TypeError("The list of script URL patterns is empty"));var a=function(t,n){return e(t).catch((function(t){if(n+1>=5)throw t;!function(t){if(!(t instanceof Error))return!1;var e=t.message;return e===bo||e===wo}(t)?i.postpone():i.exclude();var e,o=i.current();if(void 0===o)throw t;return(e=r(),new Promise((function(t){return setTimeout(t,e)}))).then((function(){return a(o,n+1)}))}))};return a(s,0)}(t,(function(t){var o=new Date,i=function(e){return n.push({url:t,startedAt:o,finishedAt:new Date,error:e})},r=e(t);return r.then((function(){return i()}),i),r})).then((function(t){return[t,{attempts:n}]}))}var ko="Failed to load the JS script of the agent";function Io(n){var o;n.scriptUrlPattern;var i=n.token,r=n.apiKey,s=void 0===r?i:r,a=e(n,["scriptUrlPattern","token","apiKey"]),l=null!==(o=function(t,e){return function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(t,e)?t[e]:void 0}(n,"scriptUrlPattern"))&&void 0!==o?o:"https://fpnpmcdn.net/v<version>/<apiKey>/loader_v<loaderVersion>.js";return Promise.resolve().then((function(){if(!s||"string"!=typeof s)throw new Error("API key required");var t=function(t,e){return(Array.isArray(t)?t:[t]).map((function(t){return function(t,e){var n=encodeURIComponent;return t.replace(/<[^<>]+>/g,(function(t){return"<version>"===t?"3":"<apiKey>"===t?n(e):"<loaderVersion>"===t?n("3.8.5"):t}))}(String(t),e)}))}(l,s);return yo(t,xo).catch(jo)})).then((function(e){var n=e[0],o=e[1];return n.load(t(t({},a),{ldi:o}))}))}function xo(t){return function(t,e,n,o){var i,r=document,s="securitypolicyviolation",a=function(e){var n=new URL(t,location.href),o=e.blockedURI;o!==n.href&&o!==n.protocol.slice(0,-1)&&o!==n.origin||(i=e,l())};r.addEventListener(s,a);var l=function(){return r.removeEventListener(s,a)};return Promise.resolve().then(e).then((function(t){return l(),t}),(function(t){return new Promise((function(t){return setTimeout(t)})).then((function(){if(l(),i)return function(){throw new Error(bo)}();throw t}))}))}(t,(function(){return function(t){return new Promise((function(e,n){var o=document.createElement("script"),i=function(){var t;return null===(t=o.parentNode)||void 0===t?void 0:t.removeChild(o)},r=document.head||document.getElementsByTagName("head")[0];o.onload=function(){i(),e()},o.onerror=function(){i(),n(new Error(ko))},o.async=!0,o.src=t,r.appendChild(o)}))}(t)})).then(Oo)}function Oo(){var t=window,e="__fpjs_p_l_b",n=t[e];if(function(t,e){var n,o=null===(n=Object.getOwnPropertyDescriptor)||void 0===n?void 0:n.call(Object,t,e);(null==o?void 0:o.configurable)?delete t[e]:o&&!o.writable||(t[e]=void 0)}(t,e),"function"!=typeof(null==n?void 0:n.load))throw new Error(wo);return n}function jo(t){throw t instanceof Error&&t.message===wo?new Error(ko):t}
/*! js-cookie v3.0.5 | MIT */function So(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}var Co=function t(e,n){function o(t,o,i){if("undefined"!=typeof document){"number"==typeof(i=So({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var r="";for(var s in i)i[s]&&(r+="; "+s,!0!==i[s]&&(r+="="+i[s].split(";")[0]));return document.cookie=t+"="+e.write(o,t)+r}}return Object.create({set:o,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],o={},i=0;i<n.length;i++){var r=n[i].split("="),s=r.slice(1).join("=");try{var a=decodeURIComponent(r[0]);if(o[a]=e.read(s,a),t===a)break}catch(t){}}return t?o[t]:o}},remove:function(t,e){o(t,"",So({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,So({},this.attributes,e))},withConverter:function(e){return t(So({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const Ao=(t,e)=>{var n;return["beforeRequest","afterRequest"].reduce(((n,o)=>{var i;return n[o]=[].concat((null===(i=t.hooks)||void 0===i?void 0:i[o])||[]).concat((null==e?void 0:e[o])||[]),n}),null!==(n=t.hooks)&&void 0!==n?n:t.hooks={}),t},Eo=async t=>{if(!(null==t?void 0:t.ok))return{};const e=await(null==t?void 0:t.clone().json());return(null==e?void 0:e.authInfo)||e||{}},Uo=async t=>{const e=await Eo(t);return(null==e?void 0:e.user)||((null==e?void 0:e.hasOwnProperty("userId"))?e:void 0)},_o="undefined"!=typeof localStorage,Po=(t,e)=>_o&&(null===localStorage||void 0===localStorage?void 0:localStorage.setItem(t,e)),Ro=t=>_o&&(null===localStorage||void 0===localStorage?void 0:localStorage.getItem(t)),Lo=t=>_o&&(null===localStorage||void 0===localStorage?void 0:localStorage.removeItem(t)),To=(...t)=>{console.debug(...t)},$o="undefined"!=typeof window,qo=$o&&(null===localStorage||void 0===localStorage?void 0:localStorage.getItem("fingerprint.endpoint.url"))||"https://fp.descope.com",Mo=(t="",e="")=>({vsid:t,vrid:e}),Wo=(t=!1)=>{const e=localStorage.getItem("fp");if(!e)return null;const n=JSON.parse(e);return(new Date).getTime()>n.expiry&&!t?null:n.value},Do=t=>(t.body&&(t.body.fpData=Wo(!0)||Mo()),t),No="dls_last_user_login_id",Fo="dls_last_user_display_name",Ko=()=>Ro(No),Jo=()=>Ro(Fo),Ho=t=>async(...e)=>{var n;e[1]=e[1]||{};const[,o={}]=e,i=Ko(),r=Jo();return i&&(null!==(n=o.lastAuth)&&void 0!==n||(o.lastAuth={}),o.lastAuth.loginId=i,o.lastAuth.name=r),await t(...e)},zo=t=>async(...e)=>{const n=await t(...e);return Lo(No),Lo(Fo),n};function Bo(){const t=[];return{pub:e=>{t.forEach((t=>t(e)))},sub:e=>{const n=t.push(e)-1;return()=>t.splice(n,1)}}}const Vo="DS",Zo="DSR",Go=(t={},n)=>{var{refreshJwt:o,sessionJwt:i}=t,r=e(t,["refreshJwt","sessionJwt"]);void 0===n&&(n=!1),o&&Po(Zo,o),i&&(n?function(t,e,{cookiePath:n,cookieDomain:o,cookieExpiration:i}){if(e){const r=new Date(1e3*i);Co.set(t,e,{path:n,domain:o,expires:r,sameSite:"Strict",secure:!0})}}(Vo,i,r):Po(Vo,i))};function Xo(){return Ro(Zo)||""}function Yo(){return Co.get(Vo)||Ro(Vo)||""}function Qo(){Lo(Zo),Lo(Vo),Co.remove(Vo)}const ti=t=>Object.assign(t,{token:t.token||Xo()}),ei=t=>async(...e)=>{const n=await t(...e);return Qo(),n};async function ni(t){const e=function(t){var e;const n=JSON.parse(t);return n.publicKey.challenge=li(n.publicKey.challenge),n.publicKey.user.id=li(n.publicKey.user.id),null===(e=n.publicKey.excludeCredentials)||void 0===e||e.forEach((t=>{t.id=li(t.id)})),n}(t);return n=await navigator.credentials.create(e),JSON.stringify({id:n.id,rawId:ci(n.rawId),type:n.type,response:{attestationObject:ci(n.response.attestationObject),clientDataJSON:ci(n.response.clientDataJSON)}});var n}async function oi(t){const e=si(t);return ai(await navigator.credentials.get(e))}async function ii(t,e){const n=si(t);return n.signal=e.signal,n.mediation="conditional",ai(await navigator.credentials.get(n))}async function ri(t=!1){if(!$o)return Promise.resolve(!1);const e=!!(window.PublicKeyCredential&&navigator.credentials&&navigator.credentials.create&&navigator.credentials.get);return e&&t&&PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable?PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable():e}function si(t){var e;const n=JSON.parse(t);return n.publicKey.challenge=li(n.publicKey.challenge),null===(e=n.publicKey.allowCredentials)||void 0===e||e.forEach((t=>{t.id=li(t.id)})),n}function ai(t){return JSON.stringify({id:t.id,rawId:ci(t.rawId),type:t.type,response:{authenticatorData:ci(t.response.authenticatorData),clientDataJSON:ci(t.response.clientDataJSON),signature:ci(t.response.signature),userHandle:t.response.userHandle?ci(t.response.userHandle):void 0}})}function li(t){const e=t.replace(/_/g,"/").replace(/-/g,"+");return Uint8Array.from(atob(e),(t=>t.charCodeAt(0))).buffer}function ci(t){return btoa(String.fromCharCode.apply(null,new Uint8Array(t))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}var di,ui=(di=t=>({async signUp(e,n){const o=await t.webauthn.signUp.start(e,window.location.origin,n);if(!o.ok)return o;const i=await ni(o.data.options);return await t.webauthn.signUp.finish(o.data.transactionId,i)},async signIn(e){const n=await t.webauthn.signIn.start(e,window.location.origin);if(!n.ok)return n;const o=await oi(n.data.options);return await t.webauthn.signIn.finish(n.data.transactionId,o)},async signUpOrIn(e){var n;const o=await t.webauthn.signUpOrIn.start(e,window.location.origin);if(!o.ok)return o;if(null===(n=o.data)||void 0===n?void 0:n.create){const e=await ni(o.data.options);return await t.webauthn.signUp.finish(o.data.transactionId,e)}{const e=await oi(o.data.options);return await t.webauthn.signIn.finish(o.data.transactionId,e)}},async update(e,n){const o=await t.webauthn.update.start(e,window.location.origin,n);if(!o.ok)return o;const i=await ni(o.data.options);return await t.webauthn.update.finish(o.data.transactionId,i)},helpers:{create:ni,get:oi,isSupported:ri,conditional:ii}}),(...t)=>{const e=di(...t);return Object.assign(e.signUp,t[0].webauthn.signUp),Object.assign(e.signIn,t[0].webauthn.signIn),Object.assign(e.signUpOrIn,t[0].webauthn.signUpOrIn),Object.assign(e.update,t[0].webauthn.update),e}),hi=t=>Object.assign(Object.assign({},t.flow),{start:async(...e)=>{const n=await ri(),o=Object.assign(Object.assign({redirectUrl:window.location.href,location:window.location.href},e[1]),{deviceInfo:{webAuthnSupport:n}});return e[1]=o,t.flow.start(...e)}});const pi=function(...t){return e=>t.reduce(((t,e)=>e(t)),e)}((t=>n=>{var{fpKey:o,fpLoad:i}=n,r=e(n,["fpKey","fpLoad"]);return o?($o?i&&(async t=>{try{if(Wo())return;const e=(Date.now().toString(36)+Math.random().toString(36).substring(2)+Math.random().toString(36).substring(2)).substring(0,27),n=Io({apiKey:t,endpoint:qo}),o=await n,{requestId:i}=await o.get({linkedId:e});(t=>{const e={value:t,expiry:(new Date).getTime()+864e5};localStorage.setItem("fp",JSON.stringify(e))})(Mo(e,i))}catch(t){global.FB_DEBUG&&console.error(t)}})(o).catch((()=>null)):console.warn("Fingerprint is a client side only capability and will not work when running in the server"),t(Ao(r,{beforeRequest:Do}))):t(Object.assign({},r))}),(t=>n=>{var{autoRefresh:o}=n,i=e(n,["autoRefresh"]);if(!o)return t(i);const{clearAllTimers:r,setTimer:s}=(()=>{const t=[];return{clearAllTimers:()=>{for(;t.length;)clearTimeout(t.pop())},setTimer:(e,n)=>{t.push(setTimeout(e,n))}}})();let a,l;document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&new Date>a&&(To("Expiration time passed, refreshing session"),c.refresh(l))}));const c=t(Ao(i,{afterRequest:async(t,e)=>{const{refreshJwt:n,sessionJwt:o}=await Eo(e);if(401===(null==e?void 0:e.status))To("Received 401, canceling all timers"),r();else if(o){a=(t=>{const e=t.split(".");try{if(3===e.length){const t=JSON.parse(window.atob(e[1]));if(t.exp)return new Date(1e3*t.exp)}}catch(t){}return null})(o),l=n;const t=((i=a)?i.getTime()-(new Date).getTime():0)-2e4;r();const e=new Date(Date.now()+t).toLocaleTimeString("en-US",{hour12:!1});To(`Setting refresh timer for ${e}. (${t}ms)`),s((()=>{To("Refreshing session due to timer"),c.refresh(n)}),t)}var i}}));return vo(c,["logout","logoutAll"],(t=>async(...e)=>{const n=await t(...e);return To("Clearing all timers"),r(),n}))}),(t=>e=>t(Object.assign(Object.assign({},e),{baseHeaders:Object.assign({"x-descope-sdk-name":"web-js","x-descope-sdk-version":"1.4.3"},e.baseHeaders)}))),(t=>e=>{const n=Bo(),o=Bo(),i=t(Ao(e,{afterRequest:async(t,e)=>{if(401===(null==e?void 0:e.status))n.pub(null),o.pub(null);else{const t=await Uo(e);t&&o.pub(t);const{sessionJwt:i}=await Eo(e);i&&n.pub(i)}}})),r=vo(i,["logout","logoutAll"],(t=>async(...e)=>{const i=await t(...e);return n.pub(null),o.pub(null),i}));return Object.assign(r,{onSessionTokenChange:n.sub,onUserChange:o.sub})}),(t=>e=>{const n=t(Ao(e,{afterRequest:async(t,e)=>{var n;const o=await Uo(e),i=null===(n=null==o?void 0:o.loginIds)||void 0===n?void 0:n[0],r=null==o?void 0:o.name;i&&((t=>{Po(No,t)})(i),(t=>{Po(Fo,t)})(r))}}));let o=vo(n,["flow.start"],Ho);return o=vo(o,["logout","logoutAll"],zo),Object.assign(o,{getLastUserLoginId:Ko,getLastUserDisplayName:Jo})}),(t=>n=>{var{persistTokens:o,sessionTokenViaCookie:i}=n,r=e(n,["persistTokens","sessionTokenViaCookie"]);if(!o||!$o)return o&&console.warn("Storing auth tokens in local storage and cookies are a client side only capabilities and will not be done when running in the server"),t(r);const s=t(Ao(r,{beforeRequest:ti,afterRequest:async(t,e)=>{401===(null==e?void 0:e.status)?Qo():Go(await Eo(e),i)}})),a=vo(s,["logout","logoutAll"],ei);return Object.assign(a,{getRefreshToken:Xo,getSessionToken:Yo})}))(((...t)=>{const e=mo(...t);return Object.assign(Object.assign({},e),{flow:hi(e),webauthn:ui(e)})})),fi=document.createElement("template");var gi,vi,mi,bi,wi,yi,ki,Ii,xi,Oi,ji,Si,Ci,Ai,Ei,Ui,_i,Pi,Ri,Li,Ti,$i,qi,Mi,Wi,Di,Ni,Fi,Ki,Ji,Hi,zi,Bi,Vi,Zi,Gi,Xi,Yi,Qi,tr,er,nr,or,ir,rr,sr,ar,lr,cr;fi.innerHTML='\n\t<style>\n\t\t:host {\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t}\n\t\t\n\t\t#wc-root {\n\t\t\theight: 100%;\n\t\t\ttransition: opacity 300ms ease-in-out;\n\t\t}\n\n\t\t#wc-root[data-theme] {\n\t\t\tbackground-color: transparent;\n\t\t}\n\n\t\t.fade-out {\n\t\t\topacity: 0.1;\n\t\t}\n\n\t</style>\n\t<div id="wc-root"></div>\n\t';class dr extends HTMLElement{static get observedAttributes(){return["project-id","flow-id","base-url","tenant","theme","locale","debug","telemetryKey","redirect-url","auto-focus","prefer-biometrics"]}constructor(t){super(),gi.add(this),this.logger=console,vi.set(this,!1),this.loggerWrapper={error:(t,e="")=>{this.logger.error(t,e,new Error),o(this,gi,"m",qi).call(this,t,e)},warn:(t,e="")=>{this.logger.warn(t,e)},info:(t,e="",n={})=>{this.logger.info(t,e,n)}},mi.set(this,new K({deferredRedirect:!1})),bi.set(this,new K),this.nextRequestStatus=new K({isLoading:!1}),wi.set(this,void 0),yi.set(this,{popstate:o(this,gi,"m",Si).bind(this),visibilitychange:o(this,gi,"m",Ci).bind(this)}),ki.set(this,void 0),Ui.set(this,T((()=>n(this,void 0,void 0,(function*(){const t=A(this.projectId,"config.json");try{const{body:e,headers:n}=yield C(t,"json");return{projectConfig:e,executionContext:{geo:n["x-geo"]}}}catch(t){this.loggerWrapper.error("Cannot get config file","make sure that your projectId & flowId are correct")}return{}}))))),i(this,ki,t,"f"),o(this,gi,"m",Ii).call(this)}get projectId(){return this.getAttribute("project-id")}get flowId(){return this.getAttribute("flow-id")}get baseUrl(){return this.getAttribute("base-url")||void 0}get tenant(){return this.getAttribute("tenant")||void 0}get redirectUrl(){return this.getAttribute("redirect-url")||void 0}get debug(){return"true"===this.getAttribute("debug")}get locale(){return this.getAttribute("locale")||void 0}get theme(){var t,e;const n=this.getAttribute("theme");if("os"===n){return window.matchMedia&&(null===(e=null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,"(prefers-color-scheme: dark)"))||void 0===e?void 0:e.matches)?"dark":"light"}return n||"light"}get telemetryKey(){return this.getAttribute("telemetryKey")||void 0}get autoFocus(){var t;const e=null!==(t=this.getAttribute("auto-focus"))&&void 0!==t?t:"true";return"skipFirstScreen"===e?e:"true"===e}get preferBiometrics(){var t;return"true"===(null!==(t=this.getAttribute("prefer-biometrics"))&&void 0!==t?t:"true")}getExecutionContext(){return n(this,void 0,void 0,(function*(){const{executionContext:t}=yield o(this,Ui,"f").call(this);return t}))}getFlowConfig(){var t,e;return n(this,void 0,void 0,(function*(){const{projectConfig:n}=yield o(this,Ui,"f").call(this),i=(null===(t=null==n?void 0:n.flows)||void 0===t?void 0:t[this.flowId])||{};return null!==(e=i.version)&&void 0!==e||(i.version=0),i}))}getTargetLocales(){return n(this,void 0,void 0,(function*(){const t=yield this.getFlowConfig();return((null==t?void 0:t.targetLocales)||[]).map((t=>t.toLowerCase()))}))}connectedCallback(){return n(this,void 0,void 0,(function*(){if(this.shadowRoot.isConnected){if(o(this,gi,"m",xi).call(this))return void o(this,gi,"m",Oi).call(this);o(this,gi,"m",ji).call(this),o(this,gi,"m",Pi).call(this),o(this,gi,"m",_i).call(this),o(this,gi,"m",Mi).call(this);const{executionId:t,stepId:e,token:n,code:r,exchangeError:s,redirectAuthCallbackUrl:a,redirectAuthCodeChallenge:l,redirectAuthInitiator:c,oidcIdpStateId:d}=L();window.addEventListener("popstate",o(this,yi,"f").popstate),window.addEventListener("visibilitychange",o(this,yi,"f").visibilitychange),o(this,mi,"f").subscribe(o(this,gi,"m",Ei).bind(this)),o(this,bi,"f").subscribe(o(this,gi,"m",$i).bind(this)),o(this,mi,"f").update({projectId:this.projectId,flowId:this.flowId,baseUrl:this.baseUrl,tenant:this.tenant,redirectUrl:this.redirectUrl,locale:this.locale,stepId:e,executionId:t,token:n,code:r,exchangeError:s,telemetryKey:this.telemetryKey,redirectAuthCallbackUrl:a,redirectAuthCodeChallenge:l,redirectAuthInitiator:c,oidcIdpStateId:d}),o(this,bi,"f").update({isDebug:this.debug}),i(this,vi,!0,"f")}}))}disconnectedCallback(){o(this,mi,"f").unsubscribeAll(),o(this,bi,"f").unsubscribeAll(),o(this,gi,"m",Ti).call(this),window.removeEventListener("popstate",o(this,yi,"f").popstate)}attributeChangedCallback(t,e,n){if(this.shadowRoot.isConnected&&o(this,vi,"f")&&e!==n&&dr.observedAttributes.includes(t)){o(this,gi,"m",ji).call(this);const i=null===e;o(this,mi,"f").update((({stepId:e,executionId:o})=>{let r=e,s=o;return i||(s=null,r=null,P()),{[R(t)]:n,stepId:r,executionId:s}})),o(this,bi,"f").update({isDebug:this.debug})}}}vi=new WeakMap,mi=new WeakMap,bi=new WeakMap,wi=new WeakMap,yi=new WeakMap,ki=new WeakMap,Ui=new WeakMap,gi=new WeakSet,Ii=function(){this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(fi.content.cloneNode(!0)),this.rootElement=this.shadowRoot.querySelector("#wc-root")},xi=function(){return!this.shadowRoot.host.closest("form")&&_()},Oi=function(){const t=this.shadowRoot.host,e=document.createElement("form");t.parentElement.appendChild(e),e.appendChild(t)},ji=function(){const t=["base-url","tenant","theme","locale","debug","telemetryKey","redirect-url","auto-focus","prefer-biometrics"];if(dr.observedAttributes.forEach((e=>{if(!t.includes(e)&&!this[R(e)])throw Error(`${e} cannot be empty`)})),this.theme&&"light"!==this.theme&&"dark"!==this.theme)throw Error('Supported theme values are "light", "dark", or leave empty for using the OS theme')},Si=function(){const{stepId:t,executionId:e}=U();o(this,mi,"f").update({stepId:t,executionId:e})},Ci=function(){document.hidden||setTimeout((()=>{o(this,mi,"f").update({deferredRedirect:!1})}),300)},Ai=function(t,e,o){const i=o||void 0,r=!!i;this.sdk=pi(Object.assign(Object.assign({persistTokens:!0},dr.sdkConfigOverrides),{projectId:t,baseUrl:e,fpKey:i,fpLoad:r})),["start","next"].forEach((t=>{const e=this.sdk.flow[t];this.sdk.flow[t]=(...t)=>n(this,void 0,void 0,(function*(){this.nextRequestStatus.update({isLoading:!0});try{return yield e(...t)}finally{this.nextRequestStatus.update({isLoading:!1})}}))}))},Ei=function(t,e,i){return n(this,void 0,void 0,(function*(){const{projectId:e,baseUrl:n,telemetryKey:r}=t;if(i("projectId")||i("baseUrl")||i("telemetryKey")){if(!e)return;o(this,gi,"m",Ai).call(this,e,n,r)}o(this,ki,"f").call(this,t)}))},_i=function(){var t,e,i,r;return n(this,void 0,void 0,(function*(){const{projectConfig:n}=yield o(this,Ui,"f").call(this);null===(r=null===(i=null===(e=null===(t=null==n?void 0:n.cssTemplate)||void 0===t?void 0:t[this.theme])||void 0===e?void 0:e.typography)||void 0===i?void 0:i.fontFamilies)||void 0===r||r.forEach((t=>(t=>{if(!t)return;const e=document.createElement("link");e.href=t,e.rel="stylesheet",document.head.appendChild(e)})(t.url)))}))},Pi=function(){o(this,gi,"m",Ri).call(this),o(this,gi,"m",Li).call(this)},Ri=function(){return n(this,void 0,void 0,(function*(){const t=document.createElement("style"),e=A(this.projectId,"theme.css");try{const{body:n}=yield C(e,"text");t.innerText=n}catch(t){this.loggerWrapper.error("Cannot fetch theme file","make sure that your projectId & flowId are correct")}this.shadowRoot.appendChild(t)}))},Li=function(){this.rootElement.setAttribute("data-theme",this.theme)},Ti=function(){var t;null===(t=o(this,wi,"f"))||void 0===t||t.remove(),i(this,wi,null,"f")},$i=function({isDebug:t}){return n(this,void 0,void 0,(function*(){t?(yield Promise.resolve().then((function(){return fr})),i(this,wi,document.createElement("descope-debugger"),"f"),Object.assign(o(this,wi,"f").style,{position:"fixed",top:"0",right:"0",height:"100vh",width:"100vw",pointerEvents:"none",zIndex:99999}),document.body.appendChild(o(this,wi,"f"))):o(this,gi,"m",Ti).call(this)}))},qi=function(t,e){var n;t&&this.debug&&(null===(n=o(this,wi,"f"))||void 0===n||n.updateData({title:t,description:e}))},Mi=function(){this.rootElement.onkeydown=t=>{if("Enter"!==t.key)return;t.preventDefault();const e=this.rootElement.querySelectorAll("button");if(1===e.length)return void e[0].click();const n=Array.from(e).filter((t=>"button"===t.getAttribute("data-type")));1===n.length&&n[0].click()}},dr.sdkConfigOverrides={baseHeaders:{"x-descope-sdk-name":"web-component","x-descope-sdk-version":"2.9.0"}};class ur extends dr{static set sdkConfigOverrides(t){dr.sdkConfigOverrides=t}constructor(){const t=new K;super(t.update.bind(t)),Wi.add(this),this.stepState=new K({},{updateOnlyOnChange:!1}),Di.set(this,void 0),Ni.set(this,null),Fi.set(this,(()=>{clearInterval(o(this,Di,"f")),i(this,Di,null,"f")})),Ki.set(this,(t=>{var e,n,i,s,a,l,c,d,u;if(!(null==t?void 0:t.ok)){o(this,Fi,"f").call(this),o(this,Wi,"m",Qi).call(this,"error",null==t?void 0:t.error);const r=null===(e=null==t?void 0:t.response)||void 0===e?void 0:e.url,l=`${null===(n=null==t?void 0:t.response)||void 0===n?void 0:n.status} - ${null===(i=null==t?void 0:t.response)||void 0===i?void 0:i.statusText}`;return void this.loggerWrapper.error((null===(s=null==t?void 0:t.error)||void 0===s?void 0:s.errorDescription)||r,(null===(a=null==t?void 0:t.error)||void 0===a?void 0:a.errorMessage)||l)}const h=null===(d=null===(c=null===(l=t.data)||void 0===l?void 0:l.screen)||void 0===c?void 0:c.state)||void 0===d?void 0:d.errorText;(null===(u=t.data)||void 0===u?void 0:u.error)?this.loggerWrapper.error(`[${t.data.error.code}]: ${t.data.error.description}`,`${h?`${h} - `:""}${t.data.error.message}`):h&&this.loggerWrapper.error(h);const{status:f,authInfo:g,lastAuth:v}=t.data;if("completed"===f)return function(t){(null==t?void 0:t.authMethod)&&r&&localStorage.setItem(p,JSON.stringify(t))}(v),o(this,Fi,"f").call(this),void o(this,Wi,"m",Qi).call(this,"success",g);const{executionId:b,stepId:w,stepName:y,action:k,screen:I,redirect:x,webauthn:O,error:j}=t.data;k!==m?(this.loggerWrapper.info(`Step "${y||`#${w}`}" is ${f}`,"",{screen:I,status:f,stepId:w,stepName:y,action:k,error:j}),this.flowState.update({stepId:w,executionId:b,action:k,redirectTo:null==x?void 0:x.url,screenId:null==I?void 0:I.id,screenState:null==I?void 0:I.state,webauthnTransactionId:null==O?void 0:O.transactionId,webauthnOptions:null==O?void 0:O.options})):this.flowState.update({action:k})})),Ji.set(this,T((()=>n(this,void 0,void 0,(function*(){var t;try{const e=yield this.sdk.webauthn.signIn.start("",window.location.origin);return e.ok||this.loggerWrapper.error("Webauthn start failed",null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.errorMessage),e.data}catch(t){this.loggerWrapper.error("Webauthn start failed",t.message)}}))))),this.flowState=t}connectedCallback(){const t=Object.create(null,{connectedCallback:{get:()=>super.connectedCallback}});var e,o;return n(this,void 0,void 0,(function*(){this.shadowRoot.isConnected&&(null===(e=this.flowState)||void 0===e||e.subscribe(this.onFlowChange.bind(this)),null===(o=this.stepState)||void 0===o||o.subscribe(this.onStepChange.bind(this))),yield t.connectedCallback.call(this)}))}disconnectedCallback(){super.disconnectedCallback(),this.flowState.unsubscribeAll(),this.stepState.unsubscribeAll()}getHtmlFilenameWithLocale(t,e){return n(this,void 0,void 0,(function*(){let n,o=navigator.language;o&&"zh-TW"!==o&&(o=o.split("-")[0]);const i=(t||o||"").toLowerCase();return(yield this.getTargetLocales()).includes(i)&&(n=`${e}-${i}.html`),n}))}getPageContent(t,e){return n(this,void 0,void 0,(function*(){if(e)try{const{body:t}=yield C(e,"text");return t}catch(n){this.loggerWrapper.error(`Failed to fetch html page from ${e}. Fallback to url ${t}`,n)}try{const{body:e}=yield C(t,"text");return e}catch(e){this.loggerWrapper.error(`Failed to fetch html page from ${t}`,e)}return null}))}onFlowChange(t,e,r){var s,a,l,c,d,u;return n(this,void 0,void 0,(function*(){const{projectId:h,flowId:p,tenant:f,stepId:g,executionId:I,action:x,screenId:O,screenState:j,redirectTo:S,redirectUrl:C,token:U,code:P,exchangeError:R,webauthnTransactionId:L,webauthnOptions:T,redirectAuthCodeChallenge:$,redirectAuthCallbackUrl:M,redirectAuthInitiator:W,oidcIdpStateId:D,locale:N}=t;let F,K;o(this,Di,"f")&&o(this,Fi,"f").call(this);const J=this.sdk.getLastUserLoginId(),H=yield this.getFlowConfig(),z=M&&$?{callbackUrl:M,codeChallenge:$}:void 0;if(!I&&(H.conditions?({startScreenId:F,conditionInteractionId:K}=((t,e)=>{const n=null==e?void 0:e.find((({key:e,operator:n})=>{var o;if("ELSE"===e)return!0;const i=null===(o=V[e])||void 0===o?void 0:o[n];return!!(null==i?void 0:i(t))}));return n?{startScreenId:n.met.screenId,conditionInteractionId:n.met.interactionId}:{}})({loginId:J,code:P,token:U},H.conditions)):H.condition?({startScreenId:F,conditionInteractionId:K}=((t,e)=>{var n;const o=null===(n=V[null==t?void 0:t.key])||void 0===n?void 0:n[t.operator];if(!o)return{};const i=o(e)?t.met:t.unmet;return{startScreenId:null==i?void 0:i.screenId,conditionInteractionId:null==i?void 0:i.interactionId}})(H.condition,{loginId:J,code:P,token:U})):F=H.startScreenId,!q(F,D))){const t={};let e=!1;P&&(e=!0,t.exchangeCode=P,t.idpInitiated=!0),U&&(e=!0,t.token=U);const n=yield this.sdk.flow.start(p,Object.assign(Object.assign({tenant:f,redirectAuth:z,oidcIdpStateId:D},C&&{redirectUrl:C}),{lastAuth:Z(J)}),K,"",e?t:void 0,H.version);return o(this,Ki,"f").call(this,n),void("completed"!==(null===(s=null==n?void 0:n.data)||void 0===s?void 0:s.status)&&this.flowState.update({code:void 0,token:void 0}))}if(I&&(r("token")&&U||r("code")&&P||r("exchangeError")&&R)){const t=yield this.sdk.flow.next(I,g,y,{token:U,exchangeCode:P,exchangeError:R},H.version);return o(this,Ki,"f").call(this,t),void this.flowState.update({token:void 0,code:void 0,exchangeError:void 0})}if(x===v&&(r("redirectTo")||r("deferredRedirect")))return S?"android"===W&&document.hidden?void this.flowState.update({deferredRedirect:!0}):void window.location.assign(S):void this.loggerWrapper.error("Did not get redirect url");if(x===b||x===w){if(!L||!T)return void this.loggerWrapper.error("Did not get webauthn transaction id or options");let t,e,n=T;if(this.preferBiometrics&&x===b&&_()&&(yield null===(l=null===(a=window.PublicKeyCredential)||void 0===a?void 0:a.isUserVerifyingPlatformAuthenticatorAvailable)||void 0===l?void 0:l.call(a)))try{const t=JSON.parse(n);t.publicKey&&((d=t.publicKey).authenticatorSelection||(d.authenticatorSelection={}),(u=t.publicKey.authenticatorSelection).authenticatorAttachment||(u.authenticatorAttachment="platform"),n=JSON.stringify(t))}catch(t){this.loggerWrapper.info("Failed to modify webauthn create options")}null===(c=o(this,Ni,"f"))||void 0===c||c.abort(),i(this,Ni,null,"f");try{t=x===b?yield this.sdk.webauthn.helpers.create(n):yield this.sdk.webauthn.helpers.get(n)}catch(t){if("NotAllowedError"!==t.name)return void this.loggerWrapper.error(t.message);e=!0}const r=yield this.sdk.flow.next(I,g,y,{transactionId:L,response:t,cancelWebauthn:e},H.version);o(this,Ki,"f").call(this,r)}if(x===m&&i(this,Di,setInterval((()=>n(this,void 0,void 0,(function*(){const t=yield this.sdk.flow.next(I,g,k,{},H.version);o(this,Ki,"f").call(this,t)}))),2e3),"f"),!O&&!F)return void this.loggerWrapper.warn("No screen was found to show");const B=F||O,G=yield this.getHtmlFilenameWithLocale(N,B),X={direction:E(+g,+e.stepId),screenState:Object.assign(Object.assign({},j),{lastAuth:{loginId:J,name:this.sdk.getLastUserDisplayName()||J}}),htmlUrl:A(h,`${B}.html`),htmlLocaleUrl:G&&A(h,G)},Y=Z(J);q(F,D)?X.next=(t,e)=>this.sdk.flow.start(p,Object.assign({tenant:f,redirectAuth:z,oidcIdpStateId:D,lastAuth:Y},C&&{redirectUrl:C}),K,t,Object.assign(Object.assign(Object.assign({},e),P&&{exchangeCode:P,idpInitiated:!0}),U&&{token:U}),H.version):(r("projectId")||r("baseUrl")||r("executionId")||r("stepId"))&&(X.next=(...t)=>this.sdk.flow.next(I,g,...t)),this.stepState.update(X)}))}onStepChange(t,e){var i;return n(this,void 0,void 0,(function*(){const{htmlUrl:r,htmlLocaleUrl:s,direction:a,next:l,screenState:c}=t,d=document.createElement("template");d.innerHTML=yield this.getPageContent(r,s);const u=d.content.cloneNode(!0),h=((t,e)=>{var n;const o=Array.from(t.querySelectorAll("script[data-id]")).map((n=>{var o;const i=n.getAttribute("data-id"),r=null===(o=t.getElementById(i))||void 0===o?void 0:o.innerHTML,s=Function(r).bind(n.previousSibling,e);return n.remove(),s}));return null===(n=t.querySelector("scripts"))||void 0===n||n.remove(),o})(u,yield this.getExecutionContext());this.sdk.webauthn.helpers.isSupported()?yield o(this,Wi,"m",zi).call(this,u,l):u.querySelectorAll(`button[${g}="biometrics"]`).forEach((t=>t.setAttribute("disabled","true"))),H(u,c,this.errorTransformer,this.loggerWrapper),((t,e)=>{var n;e&&(null===(n=null==t?void 0:t.style)||void 0===n||n.setProperty("--totp-image",`url(data:image/jpg;base64,${e})`))})(u.querySelector("div"),null===(i=null==c?void 0:c.totp)||void 0===i?void 0:i.image);const p=()=>n(this,void 0,void 0,(function*(){try{h.forEach((t=>{t()}))}catch(t){this.loggerWrapper.error(t.message)}this.rootElement.replaceChildren(u);const t=!e.htmlUrl;((t,e,n)=>{if(!0===e||"skipFirstScreen"===e&&!n){const e=t.querySelector('input:not([aria-hidden="true"])');null==e||e.focus()}})(this.rootElement,this.autoFocus,t),o(this,Wi,"m",Xi).call(this,l),o(this,Wi,"m",Qi).call(this,"page-updated",{});if(this.rootElement.querySelector(`[${g}="polling"]`)){const t=yield l(k,{});o(this,Ki,"f").call(this,t)}}));a?o(this,Wi,"m",Yi).call(this,p,a):p()}))}}Di=new WeakMap,Ni=new WeakMap,Fi=new WeakMap,Ki=new WeakMap,Ji=new WeakMap,Wi=new WeakSet,Hi=function(t){const e=t.name;if(!["email"].includes(e)){const n=`user-${e}`;t.name=n,t.addEventListener("input",(()=>{t.name=t.value?e:n}))}},zi=function(t,e){var r;return n(this,void 0,void 0,(function*(){null===(r=o(this,Ni,"f"))||void 0===r||r.abort();const s=t.querySelector('input[autocomplete="webauthn"]');if(s&&(yield z())){const{options:t,transactionId:r}=(yield o(this,Ji,"f").call(this))||{};t&&r&&(o(this,Wi,"m",Hi).call(this,s),i(this,Ni,new AbortController,"f"),this.sdk.webauthn.helpers.conditional(t,o(this,Ni,"f")).then((t=>n(this,void 0,void 0,(function*(){const n=yield e(s.id,{transactionId:r,response:t});o(this,Ki,"f").call(this,n)})))).catch((t=>{"AbortError"!==t.name&&this.loggerWrapper.error("Conditional login failed",t.message)})))}}))},Bi=function(){return Array.from(this.shadowRoot.querySelectorAll(".descope-input")).every((t=>(t.reportValidity(),t.checkValidity())))},Vi=function(){return n(this,void 0,void 0,(function*(){const t=Array.from(this.shadowRoot.querySelectorAll(`.descope-input[name]:not([${h}])`)),e=yield Promise.all(t.map((t=>n(this,void 0,void 0,(function*(){const e=yield(t=>new Promise((e=>{var n;switch(t.type){case"checkbox":e(t.checked);break;case"file":{const o=new FileReader;(null===(n=t.files)||void 0===n?void 0:n.length)?(o.onload=t=>{const n=t.target.result;e(n)},o.readAsDataURL(t.files[0])):e(null);break}default:e(t.value)}})))(t);return{name:t.name,value:e}})))));return e.reduce(((t,e)=>Object.assign(Object.assign({},t),{[e.name]:e.value})),{})}))},Zi=function(t){const e=this.nextRequestStatus.subscribe((({isLoading:n})=>{var o,i;n?null===(o=null==t?void 0:t.classList)||void 0===o||o.add("loading"):(this.nextRequestStatus.unsubscribe(e),null===(i=null==t?void 0:t.classList)||void 0===i||i.remove("loading"))}))},Gi=function(t,e){return n(this,void 0,void 0,(function*(){if(t.formNoValidate||o(this,Wi,"m",Bi).call(this)){const i=null==t?void 0:t.getAttribute("id");o(this,Wi,"m",Zi).call(this,t);const r=yield o(this,Wi,"m",Vi).call(this),s=(n=t,Array.from((null==n?void 0:n.attributes)||[]).reduce(((t,e)=>{var n;const o=null===(n=new RegExp("^data-descope-(\\S+)$").exec(e.name))||void 0===n?void 0:n[1];return o?Object.assign(t,{[o]:e.value}):t}),{})),a=Object.assign(Object.assign(Object.assign({},s),r),{origin:window.location.origin}),l=yield e(i,a);o(this,Ki,"f").call(this,l)}var n}))},Xi=function(t){this.rootElement.querySelectorAll("button:not([data-exclude-next])").forEach((e=>{e.onclick=()=>{o(this,Wi,"m",Gi).call(this,e,t)}}))},Yi=function(t,e){this.rootElement.addEventListener("transitionend",(()=>{this.rootElement.classList.remove("fade-out"),t()}),{once:!0});const n=e===I.forward?"slide-forward":"slide-backward";Array.from(this.rootElement.getElementsByClassName("input-container")).forEach(((t,e)=>{t.style["transition-delay"]=40*e+"ms",t.classList.add(n)})),this.rootElement.classList.add("fade-out")},Qi=function(t,e){this.dispatchEvent(new CustomEvent(t,{detail:e}))},customElements.define("descope-wc",ur);const hr=document.createElement("template");hr.innerHTML=`\n<style>\n  .debugger {\n    width: 300px;\n    height: 200px;\n    background-color: #FAFAFA;\n    position: fixed;\n    font-family: "Helvetica Neue", sans-serif;\n    box-shadow: rgba(0, 0, 0, 0.1) 0px 5px 10px;\n    border-radius: 8px;\n    overflow: hidden;\n    border: 1px solid lightgrey;\n    pointer-events: initial;\n    display: flex;\n    flex-direction: column;\n    min-width: 200px;\n    max-width: 600px;\n    max-height: calc(100% - 64px);\n    min-height: 200px;\n    resize: both;\n  }\n\n  .header {\n    padding: 8px 16px;\n    display: flex;\n    align-items: center;\n    background-color: #EEEEEE;\n    cursor: move;\n    border-bottom: 1px solid #e0e0e0;\n  }\n\n  .content {\n    font-size: 14px;\n    flex-grow: 1;\n    overflow: auto;\n  }\n\n  .msg {\n    border-bottom: 1px solid lightgrey; \n    padding: 8px 16px;\n    display: flex;\n    gap: 5px;\n    background-color: #FAFAFA;\n  }\n\n  .msg.collapsible {\n    cursor: pointer;\n  }\n\n  .empty-state {\n    padding: 8px 16px;\n    background-color: #FAFAFA;\n  }\n    \n\n  .msg.collapsible:not(.collapsed) {\n    background-color: #F5F5F5;\n  }\n\n  .msg_title {\n    padding-bottom: 5px;\n    display: flex;\n    gap: 8px;\n    font-weight: 500;\n  }\n\n  .msg svg {\n    padding: 1px;\n    flex-shrink: 0;\n    margin-top: -2px;\n  }\n\n  .msg_content {\n    overflow: hidden;\n    flex-grow: 1;\n    margin-right:5px;\n  }  \n\n  .msg_desc {\n    color: #646464;\n    cursor: initial;\n  }  \n\n  .msg.collapsed .msg_desc {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  .msg.collapsible.collapsed .chevron {\n    transform: rotate(-45deg) translateX(-2px);\n  }\n\n  .msg.collapsible .chevron {\n    content: "";\n    width:6px;\n    height:6px;\n    border-bottom: 2px solid grey;\n    border-right: 2px solid grey;\n    transform: rotate(45deg) translateX(-1px);\n    margin: 5px;\n    flex-shrink:0;\n  }\n</style>\n\n<div style="top:32px; left:${window.innerWidth-300-32}px;" class="debugger">\n  <div class="header">\n    <span>Debugger messages</span>\n  </div>\n  <div class="content">\n    <div class="empty-state">\n      No errors detected 👀\n    </div>\n  </div>\n</div>\n`;class pr extends HTMLElement{constructor(){super(),tr.add(this),er.set(this,new K({messages:[]})),nr.set(this,void 0),or.set(this,void 0),ir.set(this,void 0),rr.set(this,{resize:o(this,tr,"m",cr).bind(this)}),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(hr.content.cloneNode(!0)),i(this,nr,this.shadowRoot.querySelector(".debugger"),"f"),i(this,or,o(this,nr,"f").querySelector(".content"),"f"),i(this,ir,o(this,nr,"f").querySelector(".header"),"f")}updateData(t){o(this,er,"f").update((e=>({messages:e.messages.concat(t)})))}connectedCallback(){var t;((t,e,n)=>{let o=0,i=0,r=0,s=0;function a(e){e.preventDefault(),o=r-e.clientX,i=s-e.clientY,r=e.clientX,s=e.clientY;const[a,l]=B(t,t.offsetLeft-o,t.offsetTop-i,n);t.style.top=`${l}px`,t.style.left=`${a}px`}function l(){document.onmouseup=null,document.onmousemove=null}function c(t){t.preventDefault(),r=t.clientX,s=t.clientY,document.onmouseup=l,document.onmousemove=a}e?e.onmousedown=c:t.onmousedown=c})(o(this,nr,"f"),o(this,ir,"f"),{top:"all",bottom:100,left:100,right:100}),window.addEventListener("resize",o(this,rr,"f").resize),(t=o(this,nr,"f")).onmousemove=e=>{(e.target.w&&e.target.w!==e.target.offsetWidth||e.target.h&&e.target.h!==e.target.offsetHeight)&&t.onresize(e),e.target.w=e.target.offsetWidth,e.target.h=e.target.offsetHeight},o(this,nr,"f").onresize=o(this,tr,"m",lr).bind(this),o(this,er,"f").subscribe(o(this,tr,"m",sr).bind(this))}disconnectedCallback(){o(this,er,"f").unsubscribeAll(),window.removeEventListener("resize",o(this,rr,"f").resize)}}er=new WeakMap,nr=new WeakMap,or=new WeakMap,ir=new WeakMap,rr=new WeakMap,tr=new WeakSet,sr=function(t){o(this,tr,"m",ar).call(this,t),o(this,tr,"m",lr).call(this)},ar=function(t){o(this,or,"f").innerHTML=t.messages.map((t=>`\n    <div class="msg">\n      <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M5.99984 13.167L8.99984 10.167L11.9998 13.167L13.1665 12.0003L10.1665 9.00033L13.1665 6.00033L11.9998 4.83366L8.99984 7.83366L5.99984 4.83366L4.83317 6.00033L7.83317 9.00033L4.83317 12.0003L5.99984 13.167ZM8.99984 17.3337C7.84706 17.3337 6.76373 17.1148 5.74984 16.677C4.73595 16.2398 3.854 15.6462 3.104 14.8962C2.354 14.1462 1.76039 13.2642 1.32317 12.2503C0.885393 11.2364 0.666504 10.1531 0.666504 9.00033C0.666504 7.84755 0.885393 6.76421 1.32317 5.75033C1.76039 4.73644 2.354 3.85449 3.104 3.10449C3.854 2.35449 4.73595 1.7606 5.74984 1.32283C6.76373 0.885603 7.84706 0.666992 8.99984 0.666992C10.1526 0.666992 11.2359 0.885603 12.2498 1.32283C13.2637 1.7606 14.1457 2.35449 14.8957 3.10449C15.6457 3.85449 16.2393 4.73644 16.6765 5.75033C17.1143 6.76421 17.3332 7.84755 17.3332 9.00033C17.3332 10.1531 17.1143 11.2364 16.6765 12.2503C16.2393 13.2642 15.6457 14.1462 14.8957 14.8962C14.1457 15.6462 13.2637 16.2398 12.2498 16.677C11.2359 17.1148 10.1526 17.3337 8.99984 17.3337ZM8.99984 15.667C10.8609 15.667 12.4373 15.0212 13.729 13.7295C15.0207 12.4378 15.6665 10.8614 15.6665 9.00033C15.6665 7.13921 15.0207 5.56283 13.729 4.27116C12.4373 2.97949 10.8609 2.33366 8.99984 2.33366C7.13873 2.33366 5.56234 2.97949 4.27067 4.27116C2.979 5.56283 2.33317 7.13921 2.33317 9.00033C2.33317 10.8614 2.979 12.4378 4.27067 13.7295C5.56234 15.0212 7.13873 15.667 8.99984 15.667Z" fill="#ED404A"/>\n</svg>\n\n      <div class="msg_content">\n        <div class="msg_title">\n          ${t.title}\n        </div>\n        <div class="msg_desc">\n          ${t.description}\n        </div>\n      </div>\n      <div class="chevron"></div>\n    </div>\n  `)).join("")},lr=function(){o(this,or,"f").querySelectorAll(".msg").forEach((t=>{const e=t.querySelector(".msg_desc"),n=e.scrollWidth>e.clientWidth,o=e.clientHeight>20;n||o?(t.classList.add("collapsible"),t.onclick=e=>{e.target.classList.contains("msg_desc")||t.classList.toggle("collapsed")}):(t.classList.remove("collapsible"),t.onclick=null)}))},cr=function(){const[t,e]=B(o(this,nr,"f"),Number.parseInt(o(this,nr,"f").style.left,10),Number.parseInt(o(this,nr,"f").style.top,10),{top:"all",bottom:100,left:100,right:100});o(this,nr,"f").style.top=`${e}px`,o(this,nr,"f").style.left=`${t}px`},customElements.define("descope-debugger",pr);var fr=Object.freeze({__proto__:null,default:pr})}();
